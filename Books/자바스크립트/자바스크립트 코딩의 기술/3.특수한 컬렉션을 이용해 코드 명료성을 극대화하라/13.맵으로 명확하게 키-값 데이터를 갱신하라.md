# 13.맵으로 명확하게 키-값 데이터를 갱신하라

이번 팁에서는 객체를 대체할 수 있는 Map에 대해서 살펴보자. 

맵은 특정 작업을 매우 쉽게 처리하는 특별한 종류의 컬렉션이다. 
* 객체보다 맵을 사용하는 것이 더 나은 상황이 있다. 
    * 키-값 쌍이 자주 추가되거나 삭제되는 경우 
    * 키가 문자열이 아닌 경우 


## 첫번째 상황, 키-값 쌍이 자주 추가되거나 삭제되는 경우 

이런 경우는 언제일까? 반려견 입양을 도와주는 웹사이트가 있다. 여기엔 집이 필요한 강아지들 목록이 있다. 사람들은 덩치가 큰 강아지를 원하거나 특정한 견종을 찾는 등 각자 선호하는 변려견이 다르기 때문에 강아지 목록에 필터링 기능을 추가하면 좋을 것이다. 

<pre>
<code>
const dogs = [
    {
        이름 : '맥스',
        크기 : '소형견',
        견종 : '보스턴테리어',
        색상 : '검정색',
    },
    {
        이름 : '도니',
        크기 : '대형견',
        견종 : '래브라도레트리버',
        색상 : '검정색',
    },
    {
        이름 : '섀도',
        크기 : '중형견',
        견종 : '래브라도레트리버',
        색상 : '갈색',
    }
] 
</code>
</pre>

이것은 배열이다. 여기에 적용된 필터링 조건 목록을 담은 컬렉션이 하나 더 필요하다. 필터링 조건은 키(색상)와 값(검정색)을 가진 컬렉션이다. 사용자는 필터링 조건을 추가하거나 삭제하고 모든 필터값을 제거할 수 있어야 한다. 

키 '색상', 값'검정색'을 필터링 조건 컬렉션에 추가하면 코드 베이스의 다른 부분에서는 필터링 조건을 바탕으로 객체를 필터링해 강아지 두 마리가 있는 배열이 나온다. 

먼저 새로운 정보를 담을 수 있는 빈 객체를 만든다. 

<pre>
<code>
let filters = {}
</code>
</pre>

그리고 객체의 정보를 갱신하려면 필터링 조건 추가, 필터링 조건 삭제, 모든 조건 제거라는 세 가지 동작이 필요하다. 

<pre>
<code>
function addFilters(filters, key, value){
    filters[key] = value;
}
function deleteFilters(filters, key){
    delete filters[key];
}
function clearFilters(filters){
    filters = {};
    return filters;
}
</code>
</pre>

여기서 이상한 점이 있다. 컬렉션에 키-값 설정, 삭제, 전체 제거 처럼 단지 세 가지 기본적인 동작을 수행하는 데도 불구하고 서로 다른 세 가지 패러다임을 적용한다는 것이다. 먼저 키-값 설정을 할 때는 객체 자체의 메서드를 사용했다. 다음으로 키-값 쌍을 삭제할 때는 언어에 정의된 delete 연산자를 사용했다. 끝으로 모든 필터링 조건을 제거하기 위해서 변수를 재할당했다. 

맵은 객체와 다르게 키-값 쌍을 자주 변경하는 경우에 적합하도록 특별히 설계되었다. 인터페이스가 명확하고, 메서드는 예측 가능한 이름을 가지고 있으며, 반복과 같은 동작이 내장되어 있다. 맵을 사용하면 좀 더 생산성 높은 개발자가 될 수 있다. 더 많이 예측할 수록 더 빨리 만들 수 있다. 


## 첫번째 사례에서, 본격 맵을 이용한 방식 

먼저 새로운 맵 인스턴스를 생성하고 몇 가지 데이터를 추가하자. 중괄호로 생성자를 대신할 수 있는 객체와 달리, 맵에서는 항상 명시적으로 인스턴스를 생성해야 한다. 

<pre>
<code>
let filters = new Map();
</code>
</pre>

위의 코드를 보면 맵을 할당할 때, let을 사용했다. let을 사용한 이유는 객체를 조작할 것이기 때문이다. 조작은 나쁜것이지만, 네체시타인 경우도 있다. 
자, 인스턴스를 생성한 후에 set 메서드를 이용해 데이터를 추가하자. 

<pre>
<code>
filters.set('견종', '래브라도레트리버')
</code>
</pre>

데이터를 가져오려면 get() 메서드를 사용한다. 인수로는 키만 전달한다. 

<pre>
<code>
filters.get('견종')
</code>
</pre>

데이터를 가져오고 설정하는 작업은 간단하지만, 규모가 큰 맵을 만들때는 지루할 것이다. 다행히 명세를 만든 사람이 이를 대비해 데이터를 설정할 수 있는 몇 가지 단축 기능을 생성해두었다. 

메서드를 차례로 연결해서 여러 값을 쉽게 추가할 수 있다. 새로운 인스턴스를 생성하고 바로 메서드를 연결할 수도 있다. 이런 방법을 체이닝이라고 부른다.ㅏ 

<pre>
<code>
let filters = new Map()
    .set('견종', '래브라도레트리버')
    .set('크기', '대형견')
    .set('색상', '갈색');
filter.get('크기')
</code>
</pre>

데이터를 추가하는 다른 방법도 있다. 배열을 이용해 정보를 추가할 수 있다. 
새로운 맵을 생성하고 set() 메서드를 길게 연결하는 대신에 키-값 쌍 배열을 전달하면 첫 번째 항목은 키, 두 번째 항목은 값으로 추가된다. 

<pre>
<code>
let filters = new Map(
    [
        ['견종', '래브라도레트리버'],
        ['크기', '대형견'],
        ['색상', '갈색']
    ]
)
filter.get('색상')
</code>
</pre>

값을 제거할 때는 delete 메서드를 사용하자. 

<pre>
<code>
filter.delete('색상')
</code>
</pre>

모든 키-값 쌍을 제거할 때는 clear를 사용하자. 

<pre>
<code>
filter.clear()
</code>
</pre>


여기서 살펴본 맵 메서드를 사용하면 객체 대신 맵을 사용하도록 함수를 변경할 수 있다. 

<pre>
<code>
const petFilters = new Map();

function addFilters(filters, key, value){
    filters.set(key, value);
}
function deleteFilters(filters, key){
    filters.delete(key);
}
function clearFilters(filters){
    filters.clear()
}
</code>
</pre>

변경사항은 많지 않지만 매우 중요하다. 코드가 훨씬 명료하다. 

* 이외에도 새로 작성한 함수에게서 다음의 특징을 찾아볼 수 있다.
    * 맵 인스턴스에 항상 메서드를 사용한다. 
    * delete 메서드를 사용할 수 있기 때문에 생성한 후에으는 언어 수준의 연산자를 섞지 않는다. 
    * clear 메서드를 사용할 수 있기 때문에 새로운 인스턴스를 생성할 필요가 없다. 

때문에 정보를 자주 변경하는 경우에는 객체보다 맵을 사용하는 것이 더 편하다. 모든 동작과 의도가 명료하다. 


## 객체의 또 다른 제약 : 키에 사용할 수 있는 자료형에 제약이 있다. 

가장 중요한 점은 정수를 키로 사용할 수 없다는 것이다. 

<pre>
<code>
const errors = {
    100 : '이름이 잘못되었습니다',
    200 : '이름에는 문자만 입력할 수 있습니다',
    300 : '색상이 잘못되었습니다',
}
</code>
</pre>

키 목록을 확인해보면, 문자열이 담긴 배열이 반환된다. 

<pre>
<code>
Object.keys(errors);
// ['100', '200', '300']
</code>
</pre>

### 맵은 가능하다! 

<pre>
<code>
const errors = new Map([
    [100 , '이름이 잘못되었습니다'],
    [200 , '이름에는 문자만 입력할 수 있습니다'],
    [300 , '색상이 잘못되었습니다'],
])
</code>
</pre>

맵으로 생성한 녀석을 키값만 모아서 확인해보자 .

<pre>
<code>
errors.keys();
// mapIterator {100, 200, 300}
</code>
</pre>

뭔가 새로운 것이 반환되었다. mapIterator. 이것은 매우 유용한 기능이다. 맵이터레이터를 이용하면 데이터를 순회할 수 있다. 


## 결론 : 

키-값 쌍에서 조작이 많이 일어날 경우 객체보다는 map 컬렉션을 사용할 것을 추천한다. 

* 객체는
    * 각각의 메서드에 다른 페러다임을 적용한다. 
    * 명확성이 부족하다. 
    * 키 값에 다양한 자료형을 사용할 수 없다. 

* map 컬렉션은 
    * 키-값 쌍이 자주되는 경우를 위해 특별히 설계되었다. 
    * 인터페이스가 명확하다. 
    * 메서드는 예측가능한 이름을 가지고 있다. 
    * 키 값에 다양한 자료형을 사용할 수 있다. 
    * 맵이터레이터를 사용한다. 
